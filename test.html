<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Potato Anime</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    :root {
      --bg: #1f1f2e;
      --fg: #f0f0f5;
      --accent: #ffcc00;
      --card-bg: #2a2a3e;
      --radius: 12px;
      --shadow: rgba(0,0,0,0.5);
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Vazirmatn',sans-serif; background:var(--bg); color:var(--fg); display:flex; flex-direction:column; height:100vh; }
    header { position:fixed; top:0; width:100%; height:60px; background:rgba(30,30,50,0.9); display:flex; align-items:center; justify-content:center; font-size:1.6rem; z-index:10; }
    .content { margin-top:60px; flex:1; overflow-y:auto; padding:1rem; }
    .section { margin-bottom:2rem; }
    .section-title { font-size:1.3rem; color:var(--accent); margin-bottom:1rem; }
    .list { display:grid; grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); gap:1rem; }
    .card { background:var(--card-bg); border-radius:var(--radius); overflow:hidden; box-shadow:0 4px 12px var(--shadow); transition:transform .2s; }
    .card:hover { transform:translateY(-5px); }
    .card img { width:100%; height:140px; object-fit:cover; }
    .card .info { padding:.5rem; text-align:center; }
    .card .info h4 { font-size:1rem; margin-bottom:.3rem; }
    .card .info p { font-size:.8rem; }
    footer { position:fixed; bottom:0; width:100%; height:50px; background:rgba(30,30,50,0.9); display:flex; justify-content:space-around; align-items:center; z-index:10; }
    footer button { background:none; border:none; color:var(--fg); font-size:1.2rem; cursor:pointer; transition:color .2s; }
    footer button.active, footer button:hover { color:var(--accent); }
    .modal { position:fixed; inset:0; background:rgba(0,0,0,0.7); display:none; align-items:center; justify-content:center; z-index:20; }
    .modal .box { background:var(--card-bg); padding:1.5rem; border-radius:var(--radius); width:90%; max-width:360px; }
    .modal .box h3 { text-align:center; margin-bottom:1rem; color:var(--accent); }
    .modal .box input, .modal .box select, .modal .box button { width:100%; margin-bottom:.8rem; padding:.6rem; border:none; border-radius:4px; }
    .modal .box input, .modal .box select { background:var(--bg); color:var(--fg); }
    .modal .box button { background:var(--accent); color:var(--bg); cursor:pointer; }
  </style>
</head>
<body>

  <header>ğŸŸ Potato Anime</header>

  <div class="content" id="homeView">
    <div class="section">
      <div class="section-title">ğŸ“Œ Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ø§Ù†ÛŒÙ…Ù‡â€ŒÙ‡Ø§</div>
      <div class="list" id="list-new"></div>
    </div>
    <div class="section">
      <div class="section-title">ğŸ¥” Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø®Ø¯Ø§ÛŒ Ø³ÛŒØ¨â€ŒØ²Ù…ÛŒÙ†ÛŒ</div>
      <div class="list" id="list-recommend"></div>
    </div>
    <div class="section">
      <div class="section-title">ğŸ”¥ Ù¾Ø±Ø¨Ø§Ø²Ø¯ÛŒØ¯ØªØ±ÛŒÙ†â€ŒÙ‡Ø§</div>
      <div class="list" id="list-popular"></div>
    </div>
  </div>

  <!-- Ù…Ø¯ÛŒØ±ÛŒØª -->
  <div id="manageModal" class="modal">
    <div class="box">
      <h3>ğŸ›¡ï¸ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h3>
      <input id="adminPass" type="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù…Ø¯ÛŒØ±"/>
      <button id="adminLogin">ÙˆØ±ÙˆØ¯</button>

      <div id="adminPanel" style="display:none;">
        <input id="animeTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù†ÛŒÙ…Ù‡"/>
        <input id="animeImage" placeholder="Ù„ÛŒÙ†Ú© ØªØµÙˆÛŒØ±"/>
        <select id="animeCategory">
          <option value="new">Ø¬Ø¯ÛŒØ¯</option>
          <option value="recommend">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯</option>
          <option value="popular">Ù¾Ø±Ø¨Ø§Ø²Ø¯ÛŒØ¯</option>
        </select>
        <button id="addAnime">â• Ø§ÙØ²ÙˆØ¯Ù†</button>
        <input id="deleteId" placeholder="Ø´Ù†Ø§Ø³Ù‡ Ø­Ø°Ù"/>
        <button id="deleteAnime">â– Ø­Ø°Ù</button>
      </div>

      <button id="closeManage">Ø¨Ø³ØªÙ†</button>
    </div>
  </div>

  <footer>
    <button id="btnHome" class="active"><i class="fas fa-home"></i></button>
    <button id="btnManage"><i class="fas fa-user-shield"></i></button>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const supabaseClient = supabase.createClient(
        'https://mhtkysxhhrtaubakhfmn.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1odGt5c3hoaHJ0YXViYWtoZm1uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY0NjUyNTcsImV4cCI6MjA2MjA0MTI1N30.32077cavlx8PBTp6QOw1PK66RCH3FWlAiSDM39N0VHg'
      );

      const sections = ['new','recommend','popular'];
      async function loadSection(cat) {
        const { data, error } = await supabaseClient
          .from('cards')
          .select('*')
          .eq('category', cat);
        if (error) return console.error(error);
        const container = document.getElementById('list-' + cat);
        container.innerHTML = '';
        data.forEach(item => {
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <img src="${item.image}" alt="${item.title}"/>
            <div class="info">
              <h4>${item.title}</h4>
              <p>ID: ${item.id}</p>
            </div>
          `;
          container.appendChild(card);
        });
      }
      // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
      sections.forEach(loadSection);

      // Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù¾Ø§ÙˆØ±Ù‚ÛŒ
      document.getElementById('btnHome').onclick = () => {
        document.getElementById('manageModal').style.display = 'none';
      };
      document.getElementById('btnManage').onclick = () => {
        document.getElementById('manageModal').style.display = 'flex';
        document.getElementById('adminPanel').style.display = 'none';
      };
      document.getElementById('closeManage').onclick = () => {
        document.getElementById('manageModal').style.display = 'none';
      };

      // ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†
      document.getElementById('adminLogin').onclick = () => {
        if (document.getElementById('adminPass').value === 'admin123') {
          document.getElementById('adminPanel').style.display = 'block';
        } else {
          alert('Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
        }
      };

      // Ø§ÙØ²ÙˆØ¯Ù† Ø§Ù†ÛŒÙ…Ù‡
      document.getElementById('addAnime').onclick = async () => {
        const title = document.getElementById('animeTitle').value.trim();
        const image = document.getElementById('animeImage').value.trim();
        const category = document.getElementById('animeCategory').value;
        if (!title || !image) {
          return alert('Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯');
        }
        await supabaseClient
          .from('cards')
          .insert([{ title, image, category }]);
        loadSection(category);
      };

      // Ø­Ø°Ù Ø§Ù†ÛŒÙ…Ù‡
      document.getElementById('deleteAnime').onclick = async () => {
        const id = document.getElementById('deleteId').value.trim();
        if (!id) {
          return alert('Ù„Ø·ÙØ§Ù‹ Ø´Ù†Ø§Ø³Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
        }
        await supabaseClient
          .from('cards')
          .delete()
          .eq('id', id);
        sections.forEach(loadSection);
      };
    });
  </script>

</body>
</html>

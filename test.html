<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Potato Anime</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root { --bg-start:#1f1f2e; --bg-end:#121217; --card-bg:#2a2a3e; --modal-bg:rgba(40,40,60,0.9); --accent:#ffcc00; --text-main:#f0f0f5; --text-muted:#b0b0bf; --shadow:rgba(0,0,0,0.5); --radius:12px; --input-bg:#333437; }
    * { box-sizing:border-box; margin:0; padding:0; }
    body { font-family:'Vazirmatn',sans-serif; background:linear-gradient(145deg,var(--bg-start),var(--bg-end)); color:var(--text-main); display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    header { position:fixed; top:0; left:0; right:0; background:rgba(30,30,50,0.8); backdrop-filter:blur(8px); color:var(--accent); padding:1rem; text-align:center; font-size:1.6rem; z-index:100; }
    .hamburger { position:fixed; top:1rem; right:1rem; width:30px; height:24px; display:flex; flex-direction:column; justify-content:space-between; cursor:pointer; z-index:110; }
    .hamburger span { height:4px; background:var(--accent); border-radius:2px; }
    #sidebar { position:fixed; top:0; right:-260px; width:260px; height:100%; background:rgba(30,30,50,0.9); backdrop-filter:blur(8px); padding:2rem 1rem; transition:right .3s ease; z-index:105; }
    #sidebar.open { right:0; }
    #sidebar .close-sidebar { background:none; border:none; color:var(--accent); font-size:1.4rem; cursor:pointer; margin-bottom:1rem; }
    #sidebar ul { list-style:none; }
    #sidebar li { margin:1rem 0; }
    #sidebar a { color:var(--text-main); text-decoration:none; display:flex; align-items:center; }
    #sidebar a i { margin-left:0.5rem; }
    .content { margin-top:3.5rem; padding:1rem; overflow-y:auto; flex:1; }
    .section { margin-bottom:2rem; }
    .section-title { font-size:1.2rem; color:var(--accent); margin-bottom:.5rem; display:flex; justify-content:space-between; align-items:center; }
    .more-btn { background:var(--accent); border:none; color:var(--bg-end); padding:.3rem .6rem; border-radius:var(--radius); cursor:pointer; font-size:.8rem; }
    .anime-list { display:flex; gap:1rem; overflow-x:auto; }
    .anime-card { background:var(--card-bg); border-radius:var(--radius); overflow:hidden; width:160px; box-shadow:0 4px 12px var(--shadow); cursor:pointer; transition:transform .2s; }
    .anime-card:hover { transform:scale(1.05); }
    .img-wrapper { height:180px; overflow:hidden; }
    .img-wrapper img { width:100%; height:100%; object-fit:cover; }
    .title { padding:.5rem; font-weight:600; font-size:.9rem; background:rgba(0,0,0,0.2); }
    .details { padding:.4rem; font-size:.8rem; color:var(--text-muted); height:3rem; overflow:hidden; background:rgba(0,0,0,0.1); }
    nav { position:fixed; bottom:0; left:0; right:0; background:rgba(30,30,50,0.9); display:flex; justify-content:space-around; padding:.5rem 0; z-index:100; }
    nav button { background:none; border:none; color:var(--text-muted); font-size:.9rem; display:flex; flex-direction:column; align-items:center; cursor:pointer; }
    nav button i { font-size:1.2rem; margin-bottom:.2rem; }
    nav button.active, nav button:hover { color:var(--accent); }
    #searchModal, #loginModal, #manageModal { position:fixed; inset:0; background:var(--modal-bg); display:none; align-items:center; justify-content:center; z-index:200; }
    .modal-box { background:var(--card-bg); border-radius:var(--radius); padding:1.5rem; width:90%; max-width:400px; box-shadow:0 4px 12px var(--shadow); }
    .modal-box h3 { color:var(--accent); margin-bottom:.5rem; }
    .modal-box input, .modal-box textarea, .modal-box select { width:100%; margin:.5rem 0; padding:.6rem; background:var(--input-bg); border:none; border-radius:var(--radius); color:var(--text-main); }
    .modal-tabs { display:flex; margin:.5rem 0; }
    .modal-tabs button { flex:1; padding:.5rem; background:none; border:none; color:var(--text-main); cursor:pointer; }
    .modal-tabs button.active { background:var(--accent); color:#121217; border-radius:var(--radius); }
    .action { width:100%; padding:.7rem; background:var(--accent); border:none; border-radius:var(--radius); font-weight:600; cursor:pointer; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const SUPABASE_URL = 'https://mhtkysxhhrtaubakhfmn.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBh...N0VHg';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  </script>
</head>
<body>
  <header>🍟 Potato Anime</header>
  <div class="hamburger" onclick="sidebar.classList.toggle('open')"><span></span><span></span><span></span></div>
  <div id="sidebar"><button class="close-sidebar" onclick="sidebar.classList.remove('open')">✖️</button><h3>منوی سریع</h3><ul><li><a href="#"><i class="fas fa-home"></i>خانه</a></li><li><a href="#" onclick="toggleSearch()"><i class="fas fa-search"></i>جست‌وجو</a></li><li><a href="#" onclick="toggleLogin()"><i class="fas fa-user-lock"></i>ورود ادمین</a></li></ul></div>

  <div class="content">
    <div class="section"><div class="section-title">📌 جدیدترین انیمه‌ها<button class="more-btn">بیشتر</button></div><div id="list-new" class="anime-list"><div class="anime-card" onclick="window.open('https://example.com','_blank')"><div class="img-wrapper"><img src="https://via.placeholder.com/160x180" alt="نمونه انیمه"></div><div class="title">نمونه انیمه</div><div class="details">این یک کارت نمونه برای نمایش است.</div></div></div></div>
    <div class="section"><div class="section-title">🥔 پیشنهاد خدای سیب‌زمینی<button class="more-btn">بیشتر</button></div><div id="list-recommend" class="anime-list"><div class="anime-card"><div class="img-wrapper"><img src="https://via.placeholder.com/160x180" alt="نمونه انیمه"></div><div class="title">نمونه انیمه</div><div class="details">این یک کارت نمونه برای نمایش است.</div></div></div></div>
    <div class="section"><div class="section-title">🔥 پربازدیدترین‌ها<button class="more-btn">بیشتر</button></div><div id="list-popular" class="anime-list"><div class="anime-card"><div class="img-wrapper"><img src="https://via.placeholder.com/160x180" alt="نمونه انیمه"></div><div class="title">نمونه انیمه</div><div class="details">این یک کارت نمونه برای نمایش است.</div></div></div></div>
  </div>

  <div id="searchModal" class="modal-bg"><div class="modal-box"><button onclick="toggleSearch()" style="float:right;background:none;border:none;color:var(--accent);font-size:1.2rem;">✖️</button><h3>جست‌وجوی انیمه</h3><input id="searchInput" type="text" placeholder="🔍 عنوان انیمه..." oninput="performSearch(this.value)"><div id="searchResults" class="anime-list"></div></div></div>
  <div id="loginModal" class="modal-bg"><div class="modal-box"><button onclick="toggleLogin()" style="float:right;background:none;border:none;color:var(--accent);font-size:1.2rem;">✖️</button><h3>رمز ادمین</h3><input id="loginPass" type="password" placeholder="رمز عبور"><button id="loginBtn" class="action">ورود</button></div></div>
  <div id="manageModal" class="modal-bg"><div class="modal-box"><button onclick="manageModal.style.display='none'" style="float:right;background:none;border:none;color:var(--accent);font-size:1.2rem;">✖️</button><h3>مدیریت انیمه‌ها</h3><select id="mCategory"><option value="new">جدیدترین</option><option value="recommend">توصیه‌شده</option><option value="popular">پربازدید</option></select><div class="modal-tabs"><button id="tab-add" class="active">➕ افزودن</button><button id="tab-delete">➖ حذف</button></div><div id="pane-add"><input id="mTitle" placeholder="عنوان"><input id="mImage" placeholder="آدرس تصویر" oninput="imgPreview.src=this.value"><img id="imgPreview" src="https://via.placeholder.com/300x200?text=Preview" alt="Preview"><input id="mLink" placeholder="لینک"><textarea id="mDescription" placeholder="توضیحات"></textarea><button id="addCardBtn" class="action">افزودن کارت</button></div><div id="pane-delete" style="display:none"><input id="deleteSearch" placeholder="جستجو" oninput="updateDeleteList()"><div id="deleteList"></div></div></div></div>

  <nav><button class="active" onclick="window.scrollTo({top:0,behavior:'smooth'})"><i class="fas fa-home"></i>خانه</button><button onclick="toggleSearch()"><i class="fas fa-search"></i>جست‌وجو</button><button onclick="toggleLogin()"><i class="fas fa-user-lock"></i>ورود ادمین</button></nav>

  <script>
    const sidebar=document.getElementById('sidebar'),searchModal=document.getElementById('searchModal'),loginModal=document.getElementById('loginModal'),manageModal=document.getElementById('manageModal');
    const tabAdd=document.getElementById('tab-add'),tabDelete=document.getElementById('tab-delete');
    const paneAdd=document.getElementById('pane-add'),paneDelete=document.getElementById('pane-delete');
    const searchInput=document.getElementById('searchInput'),searchResults=document.getElementById('searchResults');
    const mCategory=document.getElementById('mCategory'),deleteSearch=document.getElementById('deleteSearch'),deleteList=document.getElementById('deleteList');
    const loginPass=document.getElementById('loginPass'),loginBtn=document.getElementById('loginBtn');
    let sections={new:[],recommend:[],popular:[]};
    tabAdd.onclick=()=>switchPane('add');tabDelete.onclick=()=>switchPane('delete');function switchPane(type){paneAdd.style.display=type==='add'?'block':'none';paneDelete.style.display=type==='delete'?'block':'none';tabAdd.classList.toggle('active',type==='add');tabDelete.classList.toggle('active',type==='delete');}
    function toggleSearch(){searchModal.style.display=searchModal.style.display==='flex'?'none':'flex';searchInput.value='';searchResults.innerHTML='';}
    async function performSearch(q){const{data}=await supabase.from('Potatoanime').select('*').ilike('title',`%${q}%`);searchResults.innerHTML='';data.forEach(i=>{const card=document.createElement('div');card.className='anime-card';card.onclick=()=>window.open(i.link,'_blank');card.innerHTML=`<div class="img-wrapper"><img src="${i.image}" alt="${i.title}"></div><div class="title">${i.title}</div>`;searchResults.appendChild(card);});}
    function toggleLogin(){loginModal.style.display='flex';}
    loginBtn.onclick=()=>{if(loginPass.value==='admin123'){localStorage.setItem('isAdmin','true');loginModal.style.display='none';openManage();}else alert('رمز اشتباه');};
    function openManage(){if(localStorage.getItem('isAdmin')==='true'){manageModal.style.display='flex';switchPane('add');updateDeleteList();fetchSections();}}
    function updateDeleteList(){deleteList.innerHTML='';const cat=mCategory.value;sections[cat].filter(i=>i.title.toLowerCase().includes(deleteSearch.value.toLowerCase())).forEach(i=>{const d=document.createElement('div');d.textContent=i.title;d.onclick=()=>deleteCard(i.id);deleteList.appendChild(d);});}
    async function fetchSections(){const{data}=await supabase.from('Potatoanime').select('*').order('created_at');sections={new:[],recommend:[],popular:[]};data.forEach(i=>sections[i.category]?.push(i));['new','recommend','popular'].forEach(renderList);}function renderList(cat){const ctr=document.getElementById('list-'+cat);ctr.innerHTML='';sections[cat].forEach(item=>{const card=document.createElement('div');card.className='anime-card';card.onclick=()=>window.open(item.link,'_blank');card.innerHTML=`<div class="img-wrapper"><img src="${item.image}" alt="${item.title}"></div><div class="title">${item.title}</div><div class="details">${item.description}</div>`;ctr.appendChild(card);});}
    document.getElementById('addCardBtn').onclick=async()=>{const title=document.getElementById('mTitle').value.trim(),image=document.getElementById('mImage').value.trim(),link=document.getElementById('mLink').value.trim(),description=document.getElementById('mDescription').value.trim(),category=mCategory.value;if(!title||!image||!link||!description)return alert('لطفا همه فیلدها را پر کنید');await supabase.from('Potatoanime').insert([{title,image,link,description,category}]);fetchSections();manageModal.style.display='none';};async function deleteCard(id){await supabase.from('Potatoanime').delete().eq('id',id);fetchSections();updateDeleteList();}
    fetchSections();
  </script>
</body>
</html>

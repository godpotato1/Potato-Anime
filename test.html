<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Potato Anime</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    /* Styles */
    :root { --bg-start:#1f1f2e;--bg-end:#121217;--card-bg:#2a2a3e;--modal-bg:rgba(40,40,60,0.9);
      --accent:#ffcc00;--text-main:#f0f0f5;--text-muted:#b0b0bf;--shadow:rgba(0,0,0,0.5);
      --radius:16px;--input-bg:#333437;--btn-hover:rgba(255,204,0,0.8);
    }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Vazirmatn',sans-serif;background:linear-gradient(145deg,var(--bg-start),var(--bg-end));
      color:var(--text-main);height:100vh;display:flex;flex-direction:column;overflow:hidden;
    }
    header{position:fixed;top:0;width:100%;background:rgba(30,30,50,0.8);backdrop-filter:blur(10px);
      color:var(--accent);padding:1rem;text-align:center;font-size:1.6rem;font-weight:700;
      box-shadow:0 2px 8px var(--shadow);z-index:100;
    }
    .hamburger{position:fixed;top:1rem;right:1.5rem;width:28px;height:20px;display:flex;
      flex-direction:column;justify-content:space-between;cursor:pointer;z-index:150;
    }
    .hamburger span{height:3px;background:var(--accent);border-radius:3px;transition:0.3s;}
    #sidebar{position:fixed;top:0;right:-300px;width:300px;height:100vh;
      background:rgba(30,30,50,0.9);backdrop-filter:blur(8px);padding:2rem 1rem;
      box-shadow:-4px 0 12px var(--shadow);transition:0.3s;z-index:140;
    }
    #sidebar.open{right:0;}
    #sidebar .close-sidebar{background:none;border:none;color:var(--accent);
      font-size:1.4rem;cursor:pointer;margin-bottom:2rem;
    }
    #sidebar h3{color:var(--accent);margin-bottom:1.5rem;}
    #sidebar ul{list-style:none;}
    #sidebar li{margin:1rem 0;}
    #sidebar a{color:var(--text-main);text-decoration:none;display:flex;align-items:center;
      font-weight:600;
    }
    #sidebar i{margin-left:0.5rem;}
    nav{position:fixed;bottom:0;width:100%;background:rgba(30,30,50,0.9);
      backdrop-filter:blur(6px);display:flex;justify-content:space-around;padding:1rem 0;
      box-shadow:0 -2px 6px var(--shadow);z-index:120;
    }
    nav button{background:none;border:none;color:var(--text-muted);
      font-size:0.9rem;display:flex;flex-direction:column;align-items:center;
      cursor:pointer;transition:0.2s;
    }
    nav button i{font-size:1.3rem;margin-bottom:0.2rem;}
    nav button.active,nav button:hover{color:var(--accent);transform:scale(1.1);}
    .content{margin-top:4rem;flex:1;overflow-y:auto;padding:1rem;}
    .section{margin-bottom:2rem;}
    .section-title{display:flex;justify-content:space-between;align-items:center;
      font-size:1.25rem;font-weight:600;color:var(--accent);padding:0 0.5rem;
    }
    .section-title button{background:var(--accent);border:none;padding:0.4rem 1rem;
      border-radius:var(--radius);font-size:0.9rem;color:var(--bg-end);
      cursor:pointer;transition:0.2s;
    }
    .section-title button:hover{background:var(--btn-hover);}
    .anime-list{display:flex;overflow-x:auto;gap:1rem;padding:0 0.5rem;}
    .anime-card{flex:0 0 160px;background:var(--card-bg);
      border-radius:var(--radius);box-shadow:0 4px 12px var(--shadow);
      overflow:hidden;transition:transform 0.2s;
    }
    .anime-card:hover{transform:scale(1.05);}
    .img-wrapper{height:200px;overflow:hidden;}
    .img-wrapper img{width:100%;height:100%;object-fit:cover;}
    .title{padding:0.6rem;background:rgba(0,0,0,0.2);
      font-weight:600;font-size:1rem;
    }
    .details{padding:0.4rem;background:rgba(0,0,0,0.1);
      color:var(--text-muted);font-size:0.8rem;line-height:1.2;
    }
    #searchModal,#manageModal{position:fixed;inset:0;background:var(--modal-bg);
      display:none;align-items:center;justify-content:center;z-index:160;
    }
    .modal-box{background:var(--card-bg);border-radius:var(--radius);
      padding:1.5rem;width:90%;max-width:400px;box-shadow:0 4px 12px var(--shadow);
    }
    .modal-box h3{margin-bottom:1rem;color:var(--accent);font-size:1.2rem;
      text-align:center;
    }
    .modal-box input,.modal-box select,.modal-box button{
      width:100%;margin-bottom:0.8rem;padding:0.6rem;background:var(--input-bg);
      border:none;border-radius:4px;color:var(--text-main);font-size:0.95rem;
    }
    .modal-box .close-btn{background:none;font-size:1.2rem;
      text-align:right;padding:0;cursor:pointer;
    }
    .hidden{display:none;}
    @media(max-width:600px){.anime-card{flex:0 0 120px;}.img-wrapper{height:150px;}}
  </style>
</head>
<body>
  <header>ğŸŸ Potato Anime</header>
  <div class="hamburger" id="toggleSidebar"><span></span><span></span><span></span></div>
  <div id="sidebar">
    <button class="close-sidebar" id="closeSidebar">âœ–ï¸</button>
    <h3>Ù…Ù†ÙˆÛŒ Ø³Ø±ÛŒØ¹</h3>
    <ul>
      <li><a href="#home"><i class="fas fa-home"></i>Ø®Ø§Ù†Ù‡</a></li>
      <li><a href="#searchModal"><i class="fas fa-search"></i>Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ</a></li>
      <li><a href="#manageModal"><i class="fas fa-user-lock"></i>Ù…Ø¯ÛŒØ±ÛŒØª</a></li>
    </ul>
  </div>

  <div class="content">
    <div class="section" id="section-new">
      <div class="section-title">ğŸ“Œ Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ø§Ù†ÛŒÙ…Ù‡â€ŒÙ‡Ø§<button>Ø¨ÛŒØ´ØªØ±</button></div>
      <div class="anime-list" id="list-new"></div>
    </div>
    <div class="section" id="section-recommend">
      <div class="section-title">ğŸ¥” Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø®Ø¯Ø§ÛŒ Ø³ÛŒØ¨â€ŒØ²Ù…ÛŒÙ†ÛŒ<button>Ø¨ÛŒØ´ØªØ±</button></div>
      <div class="anime-list" id="list-recommend"></div>
    </div>
    <div class="section" id="section-popular">
      <div class="section-title">ğŸ”¥ Ù¾Ø±Ø¨Ø§Ø²Ø¯ÛŒØ¯ØªØ±ÛŒÙ†â€ŒÙ‡Ø§<button>Ø¨ÛŒØ´ØªØ±</button></div>
      <div class="anime-list" id="list-popular"></div>
    </div>
  </div>

  <!-- Search Modal -->
  <div id="searchModal"><div class="modal-box">
    <button class="close-btn" id="closeSearch">âœ–ï¸</button>
    <h3>Ø¬Ø³Øªâ€ŒÙˆØ¬ÙˆÛŒ Ø§Ù†ÛŒÙ…Ù‡</h3>
    <input type="text" id="searchInput" placeholder="ğŸ” Ø¹Ù†ÙˆØ§Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯...">
    <div id="searchResults"></div>
  </div></div>

  <!-- Manage Modal -->
  <div id="manageModal"><div class="modal-box">
    <button class="close-btn" id="closeManage">âœ–ï¸</button>
    <h3>ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±</h3>
    <input type="password" id="adminPassInput" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù…Ø¯ÛŒØ±">
    <button id="adminLoginBtn">ÙˆØ±ÙˆØ¯</button>
    <div id="managePanel" class="hidden">
      <h3>Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù†ÛŒÙ…Ù‡â€ŒÙ‡Ø§</h3>
      <select id="categorySelect">
        <option value="new">Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ†</option>
        <option value="recommend">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯</option>
        <option value="popular">Ù¾Ø±Ø¨Ø§Ø²Ø¯ÛŒØ¯</option>
      </select>
      <div style="display:flex;gap:0.5rem;">
        <button id="confirmAdd">â• Ø«Ø¨Øª Ø§ÙØ²ÙˆØ¯Ù†</button>
        <button id="confirmDel">â– Ø«Ø¨Øª Ø­Ø°Ù</button>
      </div>
      <input type="text" id="animeTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù†ÛŒÙ…Ù‡">
      <input type="url" id="animeImage" placeholder="Ù„ÛŒÙ†Ú© ØªØµÙˆÛŒØ±">
      <input type="text" id="deleteId" placeholder="Ø´Ù†Ø§Ø³Ù‡ Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù">
    </div>
  </div></div>

  <nav>
    <button data-open="#home" class="active"><i class="fas fa-home"></i>Ø®Ø§Ù†Ù‡</button>
    <button data-open="#searchModal"><i class="fas fa-search"></i>Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ</button>
    <button data-open="#manageModal"><i class="fas fa-user-lock"></i>Ù…Ø¯ÛŒØ±ÛŒØª</button>
  </nav>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot, query, where, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
    const firebaseConfig = {
      apiKey: "AIzaSyDOHY2sqnWzb_wn9HZtTRiov-BW0z1nGBs",
      authDomain: "potatoanime-39d7e.firebaseapp.com",
      projectId: "potatoanime-39d7e",
      storageBucket: "potatoanime-39d7e.appspot.com",
      messagingSenderId: "625844082207",
      appId: "1:625844082207:web:239f1e6782da52ec3e272a",
      measurementId: "G-ESZLS6CJT0"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const adminPassword="admin123";
    const categories={new:'list-new',recommend:'list-recommend',popular:'list-popular'};
    function createCard(parentId,{id,title,image}){
      const list=document.getElementById(parentId);
      const card=document.createElement('div');card.className='anime-card';
      card.innerHTML=`<div class="img-wrapper"><img src="${image}" alt="${title}"></div>
        <div class="title">${title}</div><div class="details">ID: ${id}</div>`;
      list.appendChild(card);
    }
    async function renderCategory(cat){
      const col=collection(db,'animes');
      const q=query(col,where('category','==',cat));
      const snap=await getDocs(q);
      const container=document.getElementById(categories[cat]);container.innerHTML='';
      snap.docs.forEach(d=>createCard(categories[cat],{id:d.id,...d.data()}));
    }
    Object.keys(categories).forEach(c=>{
      const col=collection(db,'animes');const q=query(col,where('category','==',c));
      onSnapshot(q,()=>renderCategory(c));
    });
    // Modals
    document.querySelectorAll('nav button[data-open]').forEach(btn=>btn.onclick=()=>{
      const sel=btn.dataset.open;
      ['searchModal','manageModal'].forEach(id=>document.getElementById(id).style.display='none');
      if(sel!=='#home') document.querySelector(sel).style.display='flex';
    });
    document.getElementById('closeSearch').onclick=_=>document.getElementById('searchModal').style.display='none';
    document.getElementById('closeManage').onclick=_=>document.getElementById('manageModal').style.display='none';
    // Admin login
    document.getElementById('adminLoginBtn').onclick=_=>{
      if(document.getElementById('adminPassInput').value===adminPassword){
        document.getElementById('managePanel').classList.remove('hidden');
      } else alert('Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
    };
    // Add/Delete
    document.getElementById('confirmAdd').onclick=async()=>{
      const cat=document.getElementById('categorySelect').value;
      const title=document.getElementById('animeTitle').value.trim();
      const image=document.getElementById('animeImage').value.trim();
      if(title&&image)await addDoc(collection(db,'animes'),{title,image,category:cat}),renderCategory(cat);
      else alert('Ù¾Ø± Ú©Ù†ÛŒØ¯');
    };
    document.getElementById('confirmDel').onclick=async()=>{
      const id=document.getElementById('deleteId').value.trim();
      if(id)await deleteDoc(doc(db,'animes',id)),Object.keys(categories).forEach(renderCategory);
      else alert('ID ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
    };
    // Sidebar toggle
    document.getElementById('toggleSidebar').onclick=_=>document.getElementById('sidebar').classList.toggle('open');
    document.getElementById('closeSidebar').onclick=_=>document.getElementById('sidebar').classList.remove('open');
  </script>
</body>
</html>
